!function(){"use strict";angular.module("tribeio",["tribe-app-directives","tribe-controllers-home","tribe-projects","tribe-contributors","tribe-twitter","tribe-project-details","tribe-project-long-documentation"]).config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!0})}]).run(function($rootScope){$rootScope.baseFullPath=angular.element("head base").first().attr("href"),$rootScope.$on("$routeChangeSuccess",function(event,next){if(next){var originalPath=next.originalPath,project=next.params&&next.params.project,pageTitle="Tomitribe.io - ";switch(originalPath){case"/":pageTitle+="Main page";break;case"/projects":pageTitle+="Projects";break;case"/p/:project":case"/projects/:project":originalPath=originalPath.replace(":project",project),pageTitle+="Project - "+project;break;case"/projects/documentation/:project":originalPath=originalPath.replace(":project",project),pageTitle+="Documentation - "+project;break;case"/contributors":pageTitle+="Contributors";break;default:pageTitle+="Unknown"}next={page_path:originalPath,page_title:pageTitle,page_location:window.location&&window.location.href};window.PROD_ENV&&window.gtag&&window.gtag("config",window.GA_ID,next)}})})}(),function(){"use strict";angular.module("tribe-contributors",["tribe-app-service","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/contributors",{templateUrl:"app/page-contributors.html"})}]).controller("ContributorsListController",["$scope","tribeAppService",function($scope,tribeAppService){tribeAppService.whenReady(function(data){$scope.contributors=_.sortBy(data.contributors,function(contributor){return-1*contributor.commits})})}]).controller("ContributorsPicturesController",["$element","$scope","tribeAppService",function($element,$scope,tribeAppService){tribeAppService.whenReady(function(data){$scope.pictures=_.map(data.pictures,function(pic){return pic.name}),$scope.selected=$scope.pictures[Math.floor(Math.random()*$scope.pictures.length)],$element.find(".tribe-picture").css("background-image","url(rest/images/about/"+$scope.selected+")"),$scope.changePicture=function(pic){$scope.selected=pic,$element.find(".tribe-picture").css("background-image","url(rest/images/about/"+$scope.selected+")")}})}])}(),function(){"use strict";angular.module("tribe-controllers-home",["tribe-app-service","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"app/page-main.html"})}]).controller("HeaderImageController",["$element","$window",function($element,$window){var el=angular.element($window);el.scroll(function(){var step=el.scrollTop();$element.css({transform:"translateY("+step/3+"px)"})})}]).controller("ProjectHighlightController",["$scope","$sce","tribeAppService",function($scope,$sce,tribeAppService){tribeAppService.whenReady(function(data){var data=_.values(data.projects),data=_.find(data,function(item){return"crest"===item.name}),description=data.longDescription;$scope.highligtedProject={name:data.name,friendlyName:data.friendlyName,description:$sce.trustAsHtml(description),snapshot:data.snapshot,icon:data.icon}})}]).controller("ProjectsCarousselController",["tribeAppService","$scope",function(tribeAppService,$scope){tribeAppService.whenReady(function(data){$scope.projects=_.values(data.projects)})}]).directive("tribeProjectsCarousel",[function(){return{link:function($scope,$element){var carousel=$element.find("div.tribe-projects-caroussel > div").first();$element.find("div:first-child").bind("click",function(){var article=$element.find("article:last-child");article.detach(),article.prependTo(carousel)}),$element.find("div:last-child").bind("click",function(){var article=$element.find("article:first-child");article.detach(),article.appendTo(carousel)})}}}]).directive("tribeScrollToTop",[function(){return{link:function($scope,$element){$element.bind("click",function(){angular.element("html, body").animate({scrollTop:0},"slow")})}}}])}(),function(){"use strict";angular.module("tribe-project-details",["tribe-app-service","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/projects/:project",{templateUrl:"app/page-project-details.html"}).when("/p/:project",{templateUrl:"app/page-project-details.html"})}]).controller("ProjectDetailsController",["$scope","$routeParams","$sce","$templateRequest","tribeAppService","$anchorScroll","$timeout","$location",function($scope,$routeParams,$sce,$templateRequest,tribeAppService,$anchorScroll,$timeout,$location){$scope.baseURI=document.baseURI,tribeAppService.whenReady(function(data){var originalDocumentation,toc,project=data.projects[$routeParams.project];$scope.project=_.clone(project),originalDocumentation=project.documentation,(toc=(originalDocumentation=angular.element(originalDocumentation)).find("#user-content-toc")).detach(),$scope.project.documentation=$sce.trustAsHtml(originalDocumentation.html()),$scope.project.toc=$sce.trustAsHtml(toc.html()),$timeout(function(){var hashValue=$location.hash();hashValue.startsWith("user-content-")||(hashValue="user-content-"+hashValue),$anchorScroll(hashValue)}),$scope.otherProjects=_.filter(_.values(data.projects),function(item){return item.name!==project.name})})}])}(),function(){"use strict";angular.module("tribe-project-long-documentation",["tribe-app-service","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/projects/documentation/:project",{templateUrl:"app/page-project-long-documentation.html"})}]).controller("ProjectLongDocumentationController",["$scope","$routeParams","$sce","$templateRequest","tribeAppService","$timeout","$location","$anchorScroll",function($scope,$routeParams,$sce,$templateRequest,tribeAppService,$timeout,$location,$anchorScroll){tribeAppService.whenReady(function(data){data=data.projects[$routeParams.project];$scope.project=_.clone(data),tribeAppService.loadLongDocumentation($routeParams.project,function(data){var data=angular.element(data),toc=data.find("#user-content-toc");toc.detach(),toc.find("#user-content-toctitle").detach(),$scope.longDocumentation=$sce.trustAsHtml(data.html()),$scope.toc=$sce.trustAsHtml(toc.html()),$timeout(function(){var hashValue=$location.hash();hashValue.startsWith("user-content-")||(hashValue="user-content-"+hashValue),$anchorScroll(hashValue)})})})}])}(),function(){"use strict";angular.module("tribe-projects",["tribe-app-service","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/projects",{templateUrl:"app/page-projects.html"})}]).controller("ProjectsController",["tribeAppService","$scope","$window",function(tribeAppService,$scope,$window){$scope.baseURI=document.baseURI,tribeAppService.whenReady(function(data){$scope.projects=_.values(data.projects)})}])}(),function(){"use strict";angular.module("tribe-twitter",["tribe-app-service"]).controller("TwitterUpdatesController",["$scope","tribeAppService","$timeout",function($scope,tribeAppService,$timeout){tribeAppService.whenReady(function(data){var tweets=data.tweets,position=($timeout(function(){$scope.$apply()},0),0);$scope.tweet=tweets[position],$scope.onClick=function(dir){"left"===dir?(position-=1)<0&&(position=tweets.length-1):(position+=1)>tweets.length-1&&(position=0),$scope.tweet=tweets[position],$timeout(function(){$scope.$apply()},0)}})}])}(),function(){"use strict";angular.module("tribe-app-directives",[]).directive("tribeShareProject",["$window",function($window){return{restrict:"A",link:function($scope,$element,$attrs){$element.bind("click",function(){var url;"twitter"===$attrs.tribeShareProject?url="https://twitter.com/intent/tweet?text=Check out http:"+$scope.baseFullPath+"projects/"+$scope.project.name:"facebook"===$attrs.tribeShareProject&&(url="http://www.facebook.com/sharer/sharer.php?u=http:"+$scope.baseFullPath+"projects/"+$scope.project.name),url&&$window.open(url,"name","width=600,height=400")})}}}])}(),function(){"use strict";angular.module("tribe-app-service",[]).factory("tribeAppService",["$http",function($http){var getPromise=$http.get("rest/application.json"),result=null;function buildMap(list,key){var map={};return _.each(list,function(item){map[item[key]]=item}),map}function normalizeArray(bean){return bean&&!_.isArray(bean)?[bean]:bean}return{loadLongDocumentation:function(projectName,callback){$http.get("rest/long_documentation.json").then(function(resp){callback(resp.data)})},whenReady:function(callback){getPromise.then(function(resp){resp=resp.data;if(!result){if(!resp.dtoPage)return;var contributors=normalizeArray(resp.dtoPage.contributors),projects=(_.each(contributors,function(contributor){contributor.contributions=normalizeArray(contributor.contributions)}),contributors=buildMap(contributors,"login"),normalizeArray(resp.dtoPage.projects)),pictures=(_.each(projects,function(project){project.contributors=_.map(normalizeArray(project.contributors),function(contributor){return contributors[contributor.login]}),project.tags=normalizeArray(project.tags)}),projects=buildMap(projects,"name"),_.each(_.values(contributors),function(contributor){var commits=0;_.each(contributor.contributions,function(contribution){contribution.project=projects[contribution.project],commits+=contribution.contributions}),contributor.commits=commits}),normalizeArray(resp.dtoPage.pictures)),resp=normalizeArray(resp.dtoPage.tweets);result={contributors:contributors,projects:projects,pictures:pictures,tweets:resp}}window.tribeAppServiceLoaded=!0,callback(result)})}}}])}();
//# sourceMappingURL=app.min.js.map
